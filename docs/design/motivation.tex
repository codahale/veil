\section{Motivation}\label{sec:motivation}

Veil is a clean-slate effort to build a secure, asynchronous, PGP-like messaging cryptosystem using
modern tools and techniques to resist new attacks from modern adversaries. PGP provides confidential
and authentic multi-receiver messaging, but with many deficiencies.

\subsection{Cryptographic Agility}\label{subsec:cryptographic-agility}

PGP~was initially released in 1991 using a symmetric algorithm called BassOmatic invented by Phil
Zimmerman himself. Since then, it's supported IDEA, DES, Triple-DES, CAST5, Blowfish, SAFER-SK128,
AES-128, AES-192, AES-256, Twofish, and Camellia, with proposed support for ChaCha20. For hash
algorithms, it's supported MD5, SHA-1, RIPE-MD160, MD2, ``double-width SHA'', TIGER/192, HAVAL,
SHA2-256, SHA2-384, SHA2-512, SHA2-224. For public key encryption, it's supported RSA, ElGamal, % chktex 8
Diffie-Hellman, and ECDH, all with different parameters. For digital signatures, it's supported RSA,
DSA, ElGamal, ECDSA, and EdDSA, again, all with different parameters.

As \textcite{langley2016} said regarding TLS:\@

\begin{displayquote}
    Cryptographic agility is a huge cost. Implementing and supporting multiple algorithms means more
    code. More code begets more bugs. More things in general means less academic focus on any one
    thing, and less testing and code-review per thing. Any increase in the number of options also
    means more combinations and a higher chance for a bad interaction to arise.
\end{displayquote}

At best, each of these algorithms represents a geometrically increasing burden on implementors,
analysts, and users. At worst, they represent a catastrophic risk to the security of the
system~\cite{nguyen2004, blessing2021}\@.

A modern system would use a limited number of cryptographic primitives and use a single instance of
each.

\subsection{Informal Constructions}\label{subsec:informal-constructions}

PGP messages use a Sign-Then-Encrypt ($\StE$) construction, which is insecure given an encryption
oracle~\cite[p. 41]{an2010}\@:

\begin{displayquote}
    In the $\StE$ scheme, the adversary $\Adversary$ can easily break the sUF-CMA security in the
    outsider model. It can ask \@[the encryption oracle] to signcrypt a message $m$ for $R'$ and get
    $C=(\textsc{Encrypt}(pk_{R'},m||\sigma),ID_S,ID_{R'})$, where $\sigma \stackrel{R}{\gets}
        \textsc{Sign}(pk_S,m)$. Then, it can recover $m||\sigma$ using $sk_{R'}$ and forge the
    signcryption ciphertext $C' = (\textsc{Encrypt}(pk_R,m||\sigma),ID_S,ID_R)$.
\end{displayquote}

This may seem like an academic distinction, but this attack is trivial to mount. If you send your
boss an angry resignation letter signed and encrypted with PGP, your boss can re-transmit that to
your future boss, encrypted with her public key.

A modern system would use established, analyzed constructions with proofs in established models to
achieve established notions with reasonable reductions to weak assumptions.

\subsection{Non-Repudiation}\label{subsec:non-repudiation}

A standard property of digital signatures is that of \emph{non-repudiation}\@, or the inability of
the signer to deny they signed a message. Any possessor of the signer's public key, a message, and a
signature can verify the signature for themselves. For explicitly signed, public messages, this is a
very desirable property. For encrypted, confidential messages, this is not.

Similar to the vindictive boss scenario above, an encrypted-then-signed PGP message can be decrypted
by an intended receiver \@(or someone in possession of their private key) and presented to a third
party as an unencrypted, signed message without having to reveal anything about themselves. The
inability of PGP to preserve the privacy context of confidential messages should rightfully have a
chilling effect on its users~\cite{borisov2004}\@.

A modern system would be designed to provide some level of deniability to confidential messages.

\subsection{Global Passive Adversaries}\label{subsec:global-passive-adversaries}

A new type of adversary which became immediately relevant to the post-Snowden era is the Global
Passive Adversary, which monitors all traffic on all links of a network. For an adversary with an
advantaged network position (e.g.\ a totalitarian state), looking for cryptographically-protected
messages is trivial given the metadata they often expose. Even privacy features like GnuPG's
\texttt{--hidden-recipients} still produce encrypted messages which are trivially identifiable as
encrypted messages, because PGP messages consist of packets with explicitly identifiable metadata.
In addition to being secure, privacy-enhancing technologies must be undetectable.

\textcite{bernstein2013} summarized this dilemma:

\begin{displayquote}
    Cryptography hides patterns in user data but does not evade censorship if the censor can
    recognize patterns in the cryptography itself.
\end{displayquote}

A modern system would produce messages without recognizable metadata or patterns.
